package com.shephertz.app42.sdk.test;

import java.io.BufferedWriter;
import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.OutputStreamWriter;
import java.io.UnsupportedEncodingException;
import java.io.Writer;
import java.util.HashMap;

import com.shephertz.app42.paas.sdk.java.ServiceAPI;
import com.shephertz.app42.paas.sdk.java.push.PushNotificationService;



public class PushSample {

	public static void main(String[] args)  {
		
		try{
			sendNotification();
		}
		catch(Exception ex){
			Log(ex.getMessage());
		}
	}
	
	public static void Log(String message){
		

		Writer writer = null;

		try {
			
			writer = new BufferedWriter(new OutputStreamWriter(
			          new FileOutputStream(new File("C:\\log.txt"),true), "utf-8"));
			
		    writer.write(message);
		    
		    writer.write(System.getProperty( "line.separator" ));
		    
		} catch (IOException ex) {} 
		
		finally {
		  
			try {
			      writer.close();
		     } catch (Exception ex) {}
		}
	}
	/**
	 * Test Method for creating the User in App42 Cloud. 
	 * @throws UnsupportedEncodingException 
	 */
	public static void sendNotification() throws UnsupportedEncodingException {
	
			String userName = "xmpp_user2";  
			// Cyrillic alphabet
	        String message = "Пользователь добавил вас в друзья";  
				  
			ServiceAPI api = new ServiceAPI("7db8952c0cab1affc363e55cf5335fe3788154b28643b2b48dca2b251852bdd8","cef22930233681f6536a0bf57d407cb78ba1b8b0d6af9c28bd206ee208e8a6ae");
			
			PushNotificationService pushnotificationService = api.buildPushNotificationService();    
			
			HashMap<String, String> otherMetaHeaders = new HashMap<String, String>();  
			
			otherMetaHeaders.put("dataEncoding", "true");  
			
			pushnotificationService.setOtherMetaHeaders(otherMetaHeaders) ;
			  
	    	pushnotificationService.sendPushMessageToUser(userName,message);      
	}

}
